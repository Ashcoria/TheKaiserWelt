on_actions = {
	on_startup = {
		effect = {
			#Opinion Modifier
			EGY = {
				add_opinion_modifier = {
					target = OTT
					modifier = KR_hostile
				}
			}
			OTT = {
				add_opinion_modifier = {
					target = EGY
					modifier = ott_egy_anger
				}
			}

			#Events
			EGY = {
				country_event = {
					id = cp.11
					days = 2920
				}
			}

			#For starting garrisons
			OTT = {
				add_manpower = 20000
				add_equipment_to_stockpile = {
					type = infantry_equipment_0
					amount = 2000
					producer = OTT
				}
			}

			#Setup the Ottoman mechanics
			every_state = {
				limit = {
					OR = {
						OTT_is_conservative_state = yes
						OTT_is_turkish_nationalist_state = yes
						OTT_is_arab_nationalist_state = yes
						OTT_is_independent_state = yes
					}
				}
				# Calculate amount of added deputies
				set_variable = { deputy_calculator = state_population_k }
				divide_variable = { deputy_calculator = 100 }
				round_variable = deputy_calculator
			}
			773 = {	#Konstantiniyye
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_none = yes
				ott_set_authority_vilayet_high = yes
			}
			341 = { #Edirne
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_very_low = yes
				ott_set_authority_vilayet_high = yes
			}
			340 = {	#Bursa
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_none = yes
				ott_set_authority_vilayet_high = yes
			}
			356 = { #Sinop
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_none = yes
				ott_set_authority_vilayet_high = yes
			}
			339 = { #Izmir
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_very_low = yes
				ott_set_authority_vilayet_high = yes
			}
			342 = { #Mugla
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_none = yes
				ott_set_authority_vilayet_high = yes
			}
			343 = {	#Afyon
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_none = yes
				ott_set_authority_vilayet_high = yes
			}
			346 = { #Konya
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_very_low = yes
				ott_set_authority_vilayet_high = yes
			}
			49 = { #Ankara
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_very_low = yes
				ott_set_authority_vilayet_high = yes
			}
			344 = {	#Adana
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_none = yes
				ott_set_authority_vilayet_high = yes
			}
			585 = { #Batumi
				ott_set_revolt_risk_medium = yes
				ott_set_authority_vilayet_medium = yes
			}
			1001 = { #Lazistan
				ott_set_revolt_risk_low = yes
				ott_set_authority_vilayet_medium = yes
			}
			1000 = { #Kars
				ott_set_revolt_risk_low = yes
				ott_set_authority_vilayet_medium = yes
			}
			355 = { #Trabzon
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_none = yes
				ott_set_authority_vilayet_high = yes
			}
			345 = {	#Sivas
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_very_low = yes
				ott_set_authority_vilayet_high = yes
			}
			350 = {	#Diyarbakir
				ott_set_revolt_risk_medium = yes
				ott_set_authority_vilayet_medium = yes
			}
			352 = {	#Van
				ott_set_revolt_risk_medium = yes
				ott_set_authority_vilayet_medium = yes
			}
			349 = { #Maras
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_none = yes
				ott_set_authority_vilayet_high = yes
			}
			354 = { #Erzurum
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_low = yes
				ott_set_authority_vilayet_high = yes
			}
			164 = { #Dodecanese
				ott_set_revolt_risk_low = yes
				ott_set_authority_vilayet_low = yes
			}
			554 = { #Suriye
				ott_set_revolt_risk_low = yes
				ott_set_authority_vilayet_low = yes
			}
			553 = { #Beyrut
				ott_set_revolt_risk_very_low = yes
				ott_set_authority_vilayet_low = yes
			}
			677 = { #Halep
				ott_set_revolt_risk_none = yes
				ott_set_authority_vilayet_low = yes
			}
			680 = { #Zor
				ott_set_revolt_risk_very_low = yes
				ott_set_authority_vilayet_low = yes
			}
			455 = { #Ma'an
				ott_set_revolt_risk_very_low = yes
				ott_set_authority_vilayet_medium = yes
			}
			453 = { #Sinai
				ott_set_revolt_risk_very_low = yes
				ott_set_authority_vilayet_low = yes
			}
			754 = { #Medina
				ott_set_revolt_risk_low = yes
				ott_set_authority_vilayet_low = yes
			}
			679 = { #Mecca
				ott_set_revolt_risk_low = yes
				ott_set_authority_vilayet_low = yes
			}
			676 = { #Mosul
				ott_set_revolt_risk_very_low = yes
				ott_set_authority_vilayet_medium = yes
			}
			819 = { #Kirkuk
				ott_set_revolt_risk_medium = yes
				ott_set_authority_vilayet_medium = yes
			}
			291 = { #Baghdad
				ott_set_revolt_risk_very_low = yes
				ott_set_authority_vilayet_medium = yes
			}
			812 = { #Basra
				ott_set_revolt_risk_low = yes
				ott_set_authority_vilayet_low = yes
			}
			187 = { #Aegean Islands
				ott_set_revolt_risk_medium = yes
				ott_set_authority_vilayet_low = yes
			}
			183 = { #Cyprus
				ott_set_revolt_risk_medium = yes
				ott_set_authority_vilayet_low = yes
			}
			995 = { #Homs
				ott_set_revolt_risk_low = yes
				ott_set_authority_vilayet_low = yes
			}
			992 = { #Haifa
				ott_set_revolt_risk_very_low = yes
				ott_set_authority_vilayet_low = yes
			}
			454 = { #Jerusalem
				ott_set_revolt_risk_high = yes
				ott_set_authority_vilayet_low = yes
			}
			184 = { #Western Thrace
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_very_low = yes
				ott_set_authority_vilayet_high = yes
			}
			1089 = { #Momchilgrad
				set_state_flag = ott_ottomanist
				ott_set_revolt_risk_medium = yes
				ott_set_authority_vilayet_high = yes
			}
			448 = { #Tripolitania
				ott_set_revolt_risk_low = yes
				ott_set_authority_vilayet_low = yes
			}
			273 = { #Fezzan
				ott_set_revolt_risk_high = yes
				ott_set_authority_vilayet_low = yes
			}
			450 = { #Benghazi
				ott_set_revolt_risk_none = yes
				ott_set_authority_vilayet_medium = yes
			}
			907 = { #Bahrain
				ott_set_revolt_risk_low = yes
				ott_set_authority_vilayet_low = yes
			}
			993 = { #Qatar
				ott_set_revolt_risk_low = yes
				ott_set_authority_vilayet_low = yes
			}
			658 = { #Abu Dhabi
				ott_set_revolt_risk_very_low = yes
				ott_set_authority_vilayet_low = yes
			}
			230 = { #Yerevan
				ott_set_revolt_risk_high = yes
				ott_set_authority_vilayet_medium = yes
			}

			#Setup Resource Concessions + caculate stability
			OTT = {
				give_resource_rights = { receiver = CAN state = 812 }
				add_dynamic_modifier = { modifier = vilayet_stability_dynamic_modifier }
				ott_evaluate_stabillity_modifier = yes
				OTT_evaluate_centralisation = yes
			}

			#Azerbaijan
			AZR = {
				give_resource_rights = { state = 229 receiver = GER }
			}

			#JBS - setup starting decisions
			JBS = {
				activate_targeted_decision = { target = 915 decision = JBS_Sway_Harb }
				activate_targeted_decision = { target = 994 decision = JBS_Sway_Hutaim }
				activate_targeted_decision = { target = 291 decision = JBS_Sway_Muntafiq }
				activate_targeted_decision = { target = 1035 decision = JBS_Sway_Anizzah }
				activate_targeted_decision = { target = 991 decision = JBS_Sway_Mutair_Dawish }
				activate_targeted_decision = { target = 675 decision = JBS_Sway_Mutair_Busayis }
				activate_targeted_decision = { target = 991 decision = JBS_Sway_Ajman }
				activate_targeted_decision = { target = 675 decision = JBS_Sway_Utaibah }
				activate_targeted_decision = { target = 656 decision = JBS_Sway_Awazim }
				# JBS decisions related to OTT interactions
				activate_targeted_decision = { target = OTT decision = JBS_Ottoman_Training }
				activate_targeted_decision = { target = OTT decision = JBS_Ottoman_Weapons_Assistance }
			}
			#SAU - setup starting decisions
			SAU = {
				activate_targeted_decision = { target = 1035 decision = SAU_Sway_Ruwala }
				activate_targeted_decision = { target = 1035 decision = SAU_Sway_Anizzah }
				activate_targeted_decision = { target = 1035 decision = SAU_Sway_Dhafir }
				activate_targeted_decision = { target = 675 decision = SAU_Sway_Mutair_Busayis }
				activate_targeted_decision = { target = 675 decision = SAU_Sway_Utaibah_Ikh }
				activate_targeted_decision = { target = 675 decision = SAU_Sway_Utaibah }
				activate_targeted_decision = { target = 292 decision = SAU_Sway_Duwasir }
			}
		}
	}

	on_war_relation_added = {
		# Remove Baku rights if Baku owner at war with resource holder somehow
		effect = {
			if = {
				limit = {
					229 = { has_variable = resource_rights_holder }
					tag = 229.owner
					FROM = { tag = 229.resource_rights_holder }
				}
				# Remove GER resource rights in AZR
				remove_resource_rights = 229
				clear_variable = 229.resource_rights_holder
			}
		}
	}

	#ROOT is winner #FROM gets annexed - For civil wars on_civil_war_end is also fired
	on_annex = {
		effect = {
			FROM = {
				# Remove GER resource rights in AZR
				if = {
					limit = { tag = GER }
					remove_resource_rights = 229
					clear_variable = 229.resource_rights_holder
				}

				# Remove OTT resource rights in JBS
				else_if = {
					limit = { tag = OTT }
					remove_resource_rights = 907
					remove_resource_rights = 993
					remove_resource_rights = 658
					remove_resource_rights = 678
				}

				# Remove FRA resource rights
				else_if = {
					limit = { tag = FRA }
					remove_resource_rights = 293
					remove_resource_rights = 447
					remove_resource_rights = 552
					remove_resource_rights = 656
				}

				# Remove Ikhwan cores
				else_if = {
					limit = { original_tag = IKH }
					every_state = {
						limit = {
							OR = {
								is_core_of = FROM
								is_claimed_by = FROM
							}
						}
						remove_core_of = FROM
						remove_claim_by = FROM
					}
					if = {
						limit = { tag = IKH }
					}
				}

				#Clear Senussi state effects if the Senussis get destroyed
				else_if = {
					limit = { tag = LBA }
					every_state = {
						limit = {
							has_dynamic_modifier = {
								modifier = pervasive_senussi_influence
							}
						}
						remove_dynamic_modifier = {
							modifier = pervasive_senussi_influence
						}
						clr_state_flag = lba_zawiya_1
						clr_state_flag = lba_zawiya_2
					}
				}

				#Disable Russo-Ottoman Convention if either tag dies
				else_if = {
					limit = { tag = RUS }
					clr_global_flag = RUSSIAN_OTTOMAN_DEAL
					remove_resource_rights = 229
					clear_variable = 229.resource_rights_holder
				}

				#Disable Russo-Ottoman Convention if either tag dies
				else_if = {
					limit = { tag = OTT }
					clr_global_flag = RUSSIAN_OTTOMAN_DEAL
				}

				#Remove CYP cores on the Aegean
				else_if = {
					limit = { tag = CYP }
					remove_state_core = 187
					remove_state_core = 164
				}

				#Fire OTT events
				else_if = {
					limit = { tag = SYR }
					if = {
						limit = { OTT = { owns_state = 554 } } #Damascus
						OTT = { country_event = { id = syrrev.8 days = 2 } }
					}
				}

				# Remove Kirkuk resource rights
				if = {
					limit = { has_country_flag = has_resource_rights_to_kirkuk }
					remove_resource_rights = 676
				}

				# Remove PAL demilitarized zones and ideas
				if = {
					limit = { tag = PAL }
					PAL_remove_demilitarized_areas = yes
					every_other_country = {
						limit = { has_country_flag = PAL_convention_member }
						PAL_remove_from_convention = yes
					}
					remove_state_core = 453
					remove_state_core = 454
					remove_state_core = 753
				}
				else_if = {
					limit = { has_country_flag = PAL_convention_member }
					PAL_remove_from_convention = yes
				}

				# clear League of Arab States
				if = {
					limit = {
						has_dynamic_modifier = {
							modifier = League_of_Arab_States_dynamic_modifier
							scope = EGY
						}
					}
					if = {
						limit = { tag = EGY }
						clear_variable = EGY.var_LOA_members
						every_country = {
							limit = {
								has_dynamic_modifier = {
									modifier = League_of_Arab_States_dynamic_modifier
									scope = EGY
								}
							}
							remove_dynamic_modifier = {
								modifier = League_of_Arab_States_dynamic_modifier
								scope = EGY
							}
						}
					}
					else = {
						remove_dynamic_modifier = {
							modifier = League_of_Arab_States_dynamic_modifier
							scope = EGY
						}
					}
				}
				else_if = {
					limit = {
						has_dynamic_modifier = {
							modifier = League_of_Arab_States_dynamic_modifier
							scope = SYR
						}
					}
					if = {
						limit = { tag = SYR }
						clear_variable = SYR.var_LOA_members
						every_country = {
							limit = {
								has_dynamic_modifier = {
									modifier = League_of_Arab_States_dynamic_modifier
									scope = SYR
								}
							}
							remove_dynamic_modifier = {
								modifier = League_of_Arab_States_dynamic_modifier
								scope = SYR
							}
						}
					}
					else = {
						remove_dynamic_modifier = {
							modifier = League_of_Arab_States_dynamic_modifier
							scope = SYR
						}
					}
				}
				else_if = {
					limit = {
						has_dynamic_modifier = {
							modifier = League_of_Arab_States_dynamic_modifier
							scope = IRQ
						}
					}
					if = {
						limit = { tag = IRQ }
						clear_variable = IRQ.var_LOA_members
						every_country = {
							limit = {
								has_dynamic_modifier = {
									modifier = League_of_Arab_States_dynamic_modifier
									scope = IRQ
								}
							}
							remove_dynamic_modifier = {
								modifier = League_of_Arab_States_dynamic_modifier
								scope = IRQ
							}
						}
					}
					else = {
						remove_dynamic_modifier = {
							modifier = League_of_Arab_States_dynamic_modifier
							scope = IRQ
						}
					}
				}
			}
		}
	}

	# ROOT is capitulated country, FROM is winner
	on_capitulation = {
		effect = {
			# Oman separate peace
			if = {
				limit = {
					tag = OMA
					is_valid_peace_target = no
					NOT = { OTT = { is_ally_with = ROOT } }
					FROM = {
						OR = {
							tag = SAU
							tag = JBS
							tag = HEJ
						}
						is_valid_peace_target = yes
					}
				}
				random_other_country = {
					limit = {
						if = {
							limit = { OMA = { is_in_faction = yes } }
							is_faction_leader = yes
							is_in_faction_with = OMA
						}
						else = {
							has_subject = OMA
						}
					}
					country_event = { id = saud.152 days = 2 }
				}
			}

			# ending Assyrian revolt
			if = {
				limit = {
					ROOT = {
						tag = ASY
					}
					FROM = {
						tag = OTT
					}
				}
				OTT = {
					country_event = ass.6
				}
			}

			# Disbanding the Cairo Pact after capitulation Egypt
			if = {
				limit = {
					ROOT = {
						tag = EGY
					}
					FROM = {
						tag = OTT
					}
				}
				EGY = {
					dismantle_faction = yes
				}
			}

			if = {
				limit = { tag = GER }
				RUS = { country_event = { id = ottfor.7701 days = 10 } }
			}

			# Benghazi goes to LBA if OTT dies
			if = {
				limit = {
					tag = OTT
					is_valid_peace_target = yes
					owns_state = 450 #Benghazi
					NOT = { owns_state = 451 } #Ajdabiya
				}
				var:451.owner = { transfer_state = 450 }
			}
		}
	}

	#FROM is war target
	on_declare_war = {
		effect = {

			#National Defense Organizations
			if = {
				limit = {
					any_allied_country = { is_actual_major = yes }
					FROM = {
						tag = OTT
					}
				}
				OTT = {
					country_event = ottfor.94 #prematurely end the Baku Conference
				}
			}

			if = {
				limit = {
					OR = {
						tag = OTT
						tag = BUL
					}
					FROM = {
						OR = {
							tag = OTT
							tag = BUL
						}
					}
				}
				OTT = { country_event = { id = ottkem.60 days = 2 } } #The Grand Vizier speaks
			}

			# Armenian Rebellion
			if = {
				limit = {
					OR = {
						AND = {
							tag = OTT
							FROM = { tag = PER }
						}
						AND = {
							tag = PER
							FROM = { tag = OTT }
						}
					}
				}
				OTT = { country_event = { id = ottsep.35 days = 4 random_days = 3 } }
			}
		}
	}

	on_government_change = {
		effect = {
			if = {
				limit = { tag = OTT }
				if = {
					limit = {
						has_idea = ott_parliament_idea
						has_democratic_government = no
					}
					remove_ideas = ott_parliament_idea
				}
				if = {
					limit = {
						has_idea = ott_centralisation_idea
						has_authoritarian_government = no
						NOT = { has_country_flag = centralist_DF }
					}
					remove_ideas = ott_centralisation_idea
				}
			}
			if = {
				limit = {
					has_country_flag = PAL_convention_member
					has_socialist_government = yes
				}
				PAL_remove_from_convention = yes
			}
		}
	}

	on_new_term_election = {
		effect = {
			### Egypt ###
			if = {
				limit = { tag = EGY }
				country_event = egy.5
				country_event = egy.6
				country_event = egy.137
				country_event = egy.138
			}
			### Georgia ###
			if = {
				limit = { tag = GEO }
				country_event = geo.120
				country_event = geo.122
			}
			### Ottomans ###
			if = {
				limit = { tag = OTT }
				country_event = ottkem.53 #Centralist 1940
			}
			### Persia ###
			if = {
				limit = { tag = PER }
				country_event = pers.38 #Presidential 1938
				country_event = pers.39 #Presidential 1942
				country_event = pers.40 #Presidential 1946
				country_event = pers.41 #Majlis 1938
				country_event = pers.42 #Majlis 1942
				country_event = pers.43 #Majlis 1946
			}
			### Yemen ###
			if = {
				limit = { tag = YEM }
				country_event = yemen.41 #Generic
			}
			### Lebanon ###
			if = {
				limit = { tag = LEB }
				country_event = leb.22
				country_event = leb.23
			}
		}
	}

	#FROM is country getting invited.
	on_offer_join_faction = {
		effect = {
			if = {
				limit = {
					tag = GER
					FROM = { tag = OTT }
				}
				OTT = { country_event = ottfor.70 } #prematurely end the Baku Conference
				RUS = { country_event = ottfor.7701 } #break the Russo-Ottoman convention
			}

			#Remove Armed Neutrality
			if = {
				limit = {
					FROM = { tag = OTT }
					OR = {
						has_idea = ott_armed_neutrality
						has_idea = ott_armed_neutrality_2
					}
				}
				if = {
					limit = { has_idea = ott_armed_neutrality }
					remove_ideas = ott_armed_neutrality
				}
				else_if = {
					limit = { has_idea = ott_armed_neutrality_2 }
					remove_ideas = ott_armed_neutrality_2
				}
			}
		}
	}

	on_war = {
		effect = {
			# Ottomans vs. Cairo Pact
			if = {
				limit = {
					OR = {
						tag = OTT
						tag = PAL
						tag = EGY
					}
				}
				OTT = {
					country_event = cp.0 #War in the Desert setup event
				}
			}

			# Persian events
			if = {
				limit = { tag = PER }
				country_event = {
					id = pers.35
					days = 2
				}
			}

			#Oman-Saudi White Peace
			if = {
				limit = {
					tag = SAU
					has_war_with = OMA
					OMA = { is_valid_peace_target = yes }
				}
				OMA = {
					add_ideas = has_scripted_peace
					activate_mission = OMA_SAU_Whitepeace
				}
				activate_mission = SAU_OMA_Whitepeace
				set_province_controller = 13749
			}

			#Egypt vs Ethiopia
			if = {
				limit = {
					OR = {
						tag = EGY
						tag = ETH
					}
				}
				ETH = { country_event = { id = egy.71 days = 2 } }
				EGY = { country_event = { id = egy.72 days = 2 } }
			}
		}
	}

	on_peace = {
		effect = {
			# Persian events
			if = {
				limit = { tag = PER }
				country_event = {
					id = pers.36
					days = 2
				}
			}

			if = {
				limit = {
					tag = PAL
					is_subject_of = OTT
				}
				every_owned_state = {
					set_demilitarized_zone = yes
				}
			}

			### Ottoman events
			if = {
				limit = { tag = OTT }
				country_event = ottgui.1
				country_event = {
					id = ottkem.63
					days = 1
				}
				country_event = {
					id = ottkem.64
					days = 60
				}
			}

			if= { ##Remove National Defense Organizations
				limit = {
					tag = OTT
					NOT = { any_enemy_country = { is_actual_major = yes } }
					has_idea = OTT_national_defense_organization
				}
				country_event = {
					id = ottfor.95
					days = 1
				}
			}

			### Greek general going home
			if = {
				limit = { original_tag = CYP }
				random_army_leader = {
					limit = { is_character = GRE_georgios_grivas }
					set_nationality = GRE
				}
			}

			### JBS becoming an Ottoman puppet
			if = {
				limit = {
					tag = JBS
					has_country_flag = jbs_revolt
					OR = {
						NOT = { has_completed_focus = JBS_unite_arabs }
						AND = {
							NOT = { has_country_leader = { character = JBS_abdallah_ibn_talal_al_rashid } }
							NOT = { has_country_leader = { character = JBS_saud_al_subhan } }
						}
					}
					OTT = {
						is_subject = no
						controls_state = 679
					}
				}
				JBS = {
					if = {
						limit = {
							has_country_flag = sau_rebellion
						}
						complete_national_focus = JBS_integrate_central_nejd
					}
					if = {
						limit = {
							has_country_flag = ikh_rebellion
						}
						complete_national_focus = JBS_destroy_ikwhan
					}
					get_current_government_type = yes
					OTT = {
						set_autonomy = {
							target = JBS
							autonomy_state = kr_ottoman_emirate
						}
					}
					restore_previous_government_type = yes
					JBS_readd_claims_after_puppeting = yes
					clr_country_flag = jbs_revolt
				}
			}
		}
	}

	#ROOT is winner #FROM is loser
	on_peaceconference_ended = {
		effect = {
			### Avoid Persian exile in Khasab
			if = {
				limit = {
					ROOT = { tag = OTT }
					FROM = {
						tag = PER
						owns_state = 347 #Khasab
						NOT = { owns_state = 266 } #Teheran
					}
				}
				annex_country = { target = FROM transfer_troops = no }
			}

			### Fix the Ottoman capital
			if = {
				limit = { tag = OTT }
				if = {
					limit = {
						773 = { #Constantinople
							is_owned_and_controlled_by = PREV
							is_capital = no
						}
					}
					set_capital = { state = 773 remember_old_capital = no }
				}
				else_if = {
					limit = {
						NOT = { owns_state = 773 } #Constantinople
						49 = { #Ankara
							is_owned_and_controlled_by = PREV
							is_capital = no
						}
					}
					set_capital = { state = 49 remember_old_capital = no }
				}
			}
			else_if = {
				limit = { FROM = { tag = OTT } }
				FROM = {
					if = {
						limit = {
							773 = { #Constantinople
								is_owned_and_controlled_by = PREV
								is_capital = no
							}
						}
						set_capital = { state = 773 remember_old_capital = no }
					}
					else_if = {
						limit = {
							NOT = { owns_state = 773 } #Constantinople
							49 = { #Ankara
								is_owned_and_controlled_by = PREV
								is_capital = no
							}
						}
						set_capital = { state = 49 remember_old_capital = no }
					}
				}
			}

			### Russo-Ottoman Pact
			if = {
				limit = {
					ROOT = {
						OR = {
							tag = RUS
							tag = OTT
						}
					}
					FROM = {
						tag = PER
					}
				}
				set_country_flag = persian_victory
				country_event = ottfor.83
			}
			if = {
				limit = {
					ROOT = {
						OR = {
							tag = RUS
							tag = OTT
						}
					}
					FROM = {
						tag = AZR
					}
				}
				set_country_flag = azeri_victory
				country_event = ottfor.83
			}

			### Arab War of Unification
			if = {
				limit = {
					tag = JBS
					FROM = { tag = SAU }
				}
				remove_ideas = JBS_arabian_war_of_unification
				SAU = { remove_ideas = SAU_arabian_war_of_unification }
				if = {
					limit = {
						NOT = {
							has_completed_focus = JBS_second_rashidi_state
						}
					}
					complete_national_focus = JBS_second_rashidi_state
				}
				OTT = { country_event = ottfor.4 }
			}
			if = {
				limit = {
					tag = SAU
					FROM = { tag = JBS }
				}
				remove_ideas = SAU_arabian_war_of_unification
				JBS = {
					remove_ideas = JBS_arabian_war_of_unification
					JBS_remove_tribal_generals = yes #remove tribal leaders from JBS so that Sa'adun could return to IRQ
				}
				country_event = { id = saud.2 days = 1 }
			}

			# Egyptian-Ottoman revolts
			if = {
				limit = {
					tag = OTT
					FROM = { tag = YEM }
				}
				country_event = { id = jbs.65 hours = 12 }
			}

			# Annexation of Cyrenaica by the Turks
			if = {
				limit = {
					FROM = { tag = LBA }
					ROOT = { tag = OTT }
				}
				OTT = {
					451 = {
						add_core_of = OTT
						ott_set_authority_vilayet_low = yes
						ott_set_revolt_risk_very_high = yes
					}
					663 = {
						add_core_of = OTT
						ott_set_authority_vilayet_low = yes
						ott_set_revolt_risk_very_high = yes
					}
					1009 = {
						add_core_of = OTT
						ott_set_authority_vilayet_low = yes
						ott_set_revolt_risk_very_high = yes
					}
				}
			}

			# Ikhwan
			if = {
				limit = {
					tag = IKH
					FROM = {
						OR = {
							tag = JBS
							tag = SAU
						}
					}
				}
				every_owned_state = {
					limit = {
						OR = {
							is_core_of = SAU
							is_core_of = JBS
						}
					}
					add_core_of = ROOT
				}
				country_event = { id = jbs.2000 days = 2 }
			}

			### The Ikhwan Victorious
			if = {
				limit = {
					original_tag = IKH
					has_global_flag = rumble_in_the_dunes
					owns_state = 915
					owns_state = 675
					owns_state = 292
					owns_state = 656
				}
				if = {
					limit = {
						has_country_leader = { character = IKH_faisal_al_duwaish }
					}
					set_cosmetic_tag = NAJ_Arabia
				}
				else_if = {
					limit = {
						has_country_leader = { character = IKH_nida_ibn_nuhair }
					}
					set_cosmetic_tag = HAL_Arabia
				}
				else_if = {
					limit = {
						has_country_leader = { character = IKH_zaidan_ibn_hithlain }
					}
					set_cosmetic_tag = HAS_Arabia
				}
				else_if = {
					limit = {
						has_country_leader = { character = IKH_sultan_ibn_humaid_ibn_bijad }
					}
					set_cosmetic_tag = UTA_Arabia
				}
				country_event = { id = jbs.2001 days = 2 }
			}

			### Give Oman back to Muscat
			if = {
				limit = {
					owns_state = 859 #Oman
					country_exists = OMA
					294 = { is_owned_and_controlled_by = OMA } #Muscat
				}
				OMA = { transfer_state = 859 }
			}

			### Syria vs Lebanon
			if = {
				limit = {
					tag = LEB
					FROM = { tag = SYR }
				}
				country_event = { id = leb.1 days = 1 }
			}

			### Egypt wins 2nd Mahdist War
			if = {
				limit = {
					tag = EGY
					FROM = { tag = SUD}
				}
				country_event = {
					id = egy.81
					days = 5
					random_days = 15
				}
			}
		}
	}

	#ROOT is new controller #FROM is old controller #FROM.FROM is state ID
	on_state_control_changed = {
		effect = {
			# Sudan peaces out with EGY
			if = {
				limit = {
					tag = SUD
					FROM = { tag = EGY }
					FROM.FROM = {
						OR = {
							state = 446 #Cairo
							state = 447 #Alexandria
						}
					}
				}
				EGY = {
					country_event = egy.8200
				}
			}

			if = {	#Clear Senussi Modifier if Arab tag takes the state
				limit = {
					ROOT = {
						OR = {
							tag = LBA
							tag = ALG
							tag = TRP
							tag = MLI
							tag = NGR
							tag = CHA
						}
					}
				}
				FROM.FROM = {
					if = {
						limit = {
							has_dynamic_modifier = { modifier = pervasive_senussi_influence }
						}
						remove_dynamic_modifier = { modifier = pervasive_senussi_influence }
						clr_state_flag = blocked_caravan
					}
				}
			}
			if = {	#Restore Senussi Modifier if non-Arab tag takes the state
				limit = {
					ROOT = {
						NOT = {
							tag = LBA
							tag = ALG
							tag = TRP
							tag = MLI
							tag = NGR
							tag = CHA
						}
					}
					LBA = {
						exists = yes
						OR = {
							is_subject_of = OTT
							is_subject = no
						}
					}
					FROM.FROM = {
						has_state_flag = lba_zawiya_2
					}
				}
				FROM.FROM = {
					add_dynamic_modifier = {
						modifier = pervasive_senussi_influence
					}
				}
			}
			if = {
				limit = {
					has_war_with = FROM
					FROM.FROM = {
						is_owned_by = FROM
						NOT = { has_state_flag = state_has_fallen }
					}
				}
				# Vienna
				if = {
					limit = {
						FROM.FROM = { state = 4 }
						ROOT = {
							controls_province = 11666
							tag = OTT
						}
					}
					country_event = { id = ottfla.15 }
				}
			}

			# Add/remove Ottoman modifiers
			if = {
				limit = { FROM.FROM = { has_variable = OTT_authority_level } }
				if = {
					limit = { tag = OTT }
					FROM.FROM = {
						if = {
							limit = {
								check_variable = { OTT_authority_level = 3 }
							}
							ott_set_authority_vilayet_high = yes
						}
						else_if = {
							limit = {
								check_variable = { OTT_authority_level = 2 }
							}
							ott_set_authority_vilayet_medium = yes
						}
						else = {
							ott_set_authority_vilayet_low = yes
						}
						if = {
							limit = {
								check_variable = { OTT_revolt_risk = 5 }
							}
							ott_set_revolt_risk_very_high = yes
						}
						else_if = {
							limit = {
								check_variable = { OTT_revolt_risk = 4 }
							}
							ott_set_revolt_risk_high = yes
						}
						else_if = {
							limit = {
								check_variable = { OTT_revolt_risk = 3 }
							}
							ott_set_revolt_risk_medium = yes
						}
						else_if = {
							limit = {
								check_variable = { OTT_revolt_risk = 2 }
							}
							ott_set_revolt_risk_low = yes
						}
						else_if = {
							limit = {
								check_variable = { OTT_revolt_risk = 1 }
							}
							ott_set_revolt_risk_very_low = yes
						}
						else_if = {
							limit = {
								check_variable = { OTT_revolt_risk = 0 }
							}
							ott_set_revolt_risk_none = yes
						}
						if = {
							limit = {
								check_variable = { corruption = 2 }
								NOT = { has_state_flag = OTT_corruption_applied }
							}
							set_state_flag = OTT_corruption_applied
							add_state_modifier = {
								modifier = {
									local_building_slots_factor = -0.20
									local_manpower = -0.50
								}
							}
						}
						else_if = {
							limit = {
								check_variable = { corruption = 1 }
								NOT = { has_state_flag = OTT_corruption_applied }
							}
							set_state_flag = OTT_corruption_applied
							add_state_modifier = {
								modifier = {
									local_building_slots_factor = -0.10
									local_manpower = -0.25
								}
							}
						}
					}
				}
				else = {
					FROM.FROM = {
						if = {
							limit = {
								has_dynamic_modifier = { modifier = autonomous_region }
							}
							remove_dynamic_modifier = { modifier = autonomous_region }
						}
						if = {
							limit = {
								has_dynamic_modifier = { modifier = vilayet }
							}
							remove_dynamic_modifier = { modifier = vilayet }
						}
						if = {
							limit = {
								has_dynamic_modifier = { modifier = ottoman_province }
							}
							remove_dynamic_modifier = { modifier = ottoman_province }
						}
						if = {
							limit = {
								has_dynamic_modifier = { modifier = high_revolt_risk }
							}
							remove_dynamic_modifier = { modifier = high_revolt_risk }
						}
						if = {
							limit = {
								has_dynamic_modifier = { modifier = very_high_revolt_risk }
							}
							remove_dynamic_modifier = { modifier = very_high_revolt_risk }
						}
						if = {
							limit = {
								check_variable = { corruption = 2 }
								has_state_flag = OTT_corruption_applied
							}
							clr_state_flag = OTT_corruption_applied
							add_state_modifier = {
								modifier = {
									local_building_slots_factor = 0.20
									local_manpower = 0.50
								}
							}
						}
						else_if = {
							limit = {
								check_variable = { corruption = 1 }
								has_state_flag = OTT_corruption_applied
							}
							clr_state_flag = OTT_corruption_applied
							add_state_modifier = {
								modifier = {
									local_building_slots_factor = 0.10
									local_manpower = 0.25
								}
							}
						}
					}
				}
			}

			### Remove Assyrian state modifiers
			if = {
				limit = {
					FROM.FROM = { has_variable = ASY_madan_resistance }
				}
				if = {
					limit = { tag = ASY }
					FROM.FROM = {
						if = {
							limit = {
								check_variable = { ASY_madan_resistance = 2 }
								NOT = { has_dynamic_modifier = { modifier = madan_resistance2 } }
							}
							add_dynamic_modifier = { modifier = madan_resistance2 }
						}
						else_if = {
							limit = {
								check_variable = { ASY_madan_resistance = 3 }
								NOT = { has_dynamic_modifier = { modifier = madan_resistance3 } }
							}
							add_dynamic_modifier = { modifier = madan_resistance3 }
						}
						else_if = {
							limit = {
								NOT = { has_dynamic_modifier = { modifier = madan_resistance } }
							}
							add_dynamic_modifier = { modifier = madan_resistance }
						}
					}
				}
				else = {
					FROM.FROM = {
						if = {
							limit = { has_dynamic_modifier = { modifier = madan_resistance } }
							remove_dynamic_modifier = { modifier = madan_resistance }
						}
						else_if = {
							limit = { has_dynamic_modifier = { modifier = madan_resistance2 } }
							remove_dynamic_modifier = { modifier = madan_resistance2 }
						}
						else_if = {
							limit = { has_dynamic_modifier = { modifier = madan_resistance3 } }
							remove_dynamic_modifier = { modifier = madan_resistance3 }
						}
					}
				}
			}
		}
	}

	#ROOT = attacking side
	#FROM = defending side
	#fired when two countries end up at war with each other (on_war is fired when a country goes to war against anyone and is not fired again when it enters war against another country unless it went to peace first)
	on_war_relation_added = {
		effect = {
			if = {
				limit = {
					has_dynamic_modifier = {
						modifier = League_of_Arab_States_dynamic_modifier
						scope = SYR
					}
					FROM = { is_ally_with = SYR }
				}
				remove_dynamic_modifier = {
					modifier = League_of_Arab_States_dynamic_modifier
					scope = SYR
				}
				add_to_variable = { SYR.var_LOA_members = -0.01 }
			}
			else_if = {
				limit = {
					has_dynamic_modifier = {
						modifier = League_of_Arab_States_dynamic_modifier
						scope = IRQ
					}
					FROM = { is_ally_with = IRQ }
				}
				remove_dynamic_modifier = {
					modifier = League_of_Arab_States_dynamic_modifier
					scope = IRQ
				}
				add_to_variable = { IRQ.var_LOA_members = -0.01 }
			}
			else_if = {
				limit = {
					has_dynamic_modifier = {
						modifier = League_of_Arab_States_dynamic_modifier
						scope = EGY
					}
					FROM = { is_ally_with = EGY }
				}
				remove_dynamic_modifier = {
					modifier = League_of_Arab_States_dynamic_modifier
					scope = EGY
				}
				add_to_variable = { EGY.var_LOA_members = -0.01 }
			}
			else_if = {
				limit = {
					is_ally_with = SYR
					FROM = {
						has_dynamic_modifier = {
							modifier = League_of_Arab_States_dynamic_modifier
							scope = SYR
						}
					}
				}
				FROM = {
					remove_dynamic_modifier = {
						modifier = League_of_Arab_States_dynamic_modifier
						scope = SYR
					}
					add_to_variable = { SYR.var_LOA_members = -0.01 }
				}
			}
			else_if = {
				limit = {
					is_ally_with = IRQ
					FROM = {
						has_dynamic_modifier = {
							modifier = League_of_Arab_States_dynamic_modifier
							scope = IRQ
						}
					}
				}
				FROM = {
					remove_dynamic_modifier = {
						modifier = League_of_Arab_States_dynamic_modifier
						scope = IRQ
					}
					add_to_variable = { IRQ.var_LOA_members = -0.01 }
				}
			}
			else_if = {
				limit = {
					is_ally_with = EGY
					FROM = {
						has_dynamic_modifier = {
							modifier = League_of_Arab_States_dynamic_modifier
							scope = EGY
						}
					}
				}
				FROM = {
					remove_dynamic_modifier = {
						modifier = League_of_Arab_States_dynamic_modifier
						scope = EGY
					}
					add_to_variable = { EGY.var_LOA_members = -0.01 }
				}
			}
		}
	}
}

