ARA_core_hail = {
	if = {
		limit = {
			NOT = { 915 = { is_core_of = ROOT } }
		}
		add_state_core = 915 #Ha'il
	}
	if = {
		limit = {
			NOT = { 994 = { is_core_of = ROOT } }
		}
		add_state_core = 994 #Jawf
	}
	if = {
		limit = {
			NOT = { 1035 = { is_core_of = ROOT } }
		}
		add_state_core = 1035 #Anizzah
	}
}

ARA_core_nejd = {
	if = {
		limit = {
			NOT = { 292 = { is_core_of = ROOT } }
		}
		add_state_core = 292 #Najd
	}
	if = {
		limit = {
			NOT = { 656 = { is_core_of = ROOT } }
		}
		add_state_core = 656 #Al-Hasa
	}
	if = {
		limit = {
			NOT = { 675 = { is_core_of = ROOT } }
		}
		add_state_core = 675 #Qassim
	}
	if = {
		limit = {
			NOT = { 678 = { is_core_of = ROOT } }
		}
		add_state_core = 678 #Rub Al Khali
	}
	if = {
		limit = {
			NOT = { 991 = { is_core_of = ROOT } }
		}
		add_state_core = 991 #Summan
	}
}

ARA_core_trucial_states = {
	if = {
		limit = {
			NOT = { 658 = { is_core_of = ROOT } }
		}
		add_state_core = 658 #Abu Dhabi
	}
	if = {
		limit = {
			NOT = { 907 = { is_core_of = ROOT } }
		}
		add_state_core = 907 #Bahrain
	}
	if = {
		limit = {
			NOT = { 993 = { is_core_of = ROOT } }
		}
		add_state_core = 993 #Qatar
	}
}

ARA_core_yemen = {
	if = {
		limit = {
			NOT = { 981 = { is_core_of = ROOT } }
		}
		add_state_core = 981 #Najran
	}
	if = {
		limit = {
			NOT = { 982 = { is_core_of = ROOT } }
		}
		add_state_core = 982 #Asir
	}
}

SAU_anger_ikhwan = {
	if = {
		limit = { has_completed_focus = SAU_saudi_hegemony }
		custom_effect_tooltip = SAU_ikhwan_provoking
		hidden_effect = {
			country_event = { id = saud.150 days = 2 }
		}
	}
}

SAU_ikhwan_raid_reward = {
	add_manpower = 300
	add_equipment_to_stockpile = {
		type = infantry_equipment
		amount = 200
		producer = TUR
	}
}

JBS_Decrease_Ulemma_Support = {
	custom_effect_tooltip = tooltip_white_line
	if = {
		limit = {
			has_idea = JBS_Ulemma_Very_Happy
		}
		swap_ideas = {
			remove_idea = JBS_Ulemma_Very_Happy
			add_idea = JBS_Ulemma_Happy
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Ulemma_Happy
		}
		swap_ideas = {
			remove_idea = JBS_Ulemma_Happy
			add_idea = JBS_Ulemma_Pleased
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Ulemma_Pleased
		}
		swap_ideas = {
			remove_idea = JBS_Ulemma_Pleased
			add_idea = JBS_Ulemma_Neutral
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Ulemma_Neutral
		}
		swap_ideas = {
			remove_idea = JBS_Ulemma_Neutral
			add_idea = JBS_Ulemma_Discontent
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Ulemma_Discontent
		}
		swap_ideas = {
			remove_idea = JBS_Ulemma_Discontent
			add_idea = JBS_Ulemma_Unhappy
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Ulemma_Unhappy
		}
		swap_ideas = {
			remove_idea = JBS_Ulemma_Unhappy
			add_idea = JBS_Ulemma_Very_Unhappy
		}
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						has_idea = JBS_unbridled_fratricide
						has_idea = JBS_looming_invasion
					}
				}
				country_event = {
					id = jbs.9
					days = 10
				}
			}
		}
	}
}
JBS_Increase_Ulemma_Support = {
	custom_effect_tooltip = tooltip_white_line
	if = {
		limit = {
			has_idea = JBS_Ulemma_Very_Unhappy
		}
		swap_ideas = {
			remove_idea = JBS_Ulemma_Very_Unhappy
			add_idea = JBS_Ulemma_Unhappy
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Ulemma_Unhappy
		}
		swap_ideas = {
			remove_idea = JBS_Ulemma_Unhappy
			add_idea = JBS_Ulemma_Discontent
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Ulemma_Discontent
		}
		swap_ideas = {
			remove_idea = JBS_Ulemma_Discontent
			add_idea = JBS_Ulemma_Neutral
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Ulemma_Neutral
		}
		swap_ideas = {
			remove_idea = JBS_Ulemma_Neutral
			add_idea = JBS_Ulemma_Pleased
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Ulemma_Pleased
		}
		swap_ideas = {
			remove_idea = JBS_Ulemma_Pleased
			add_idea = JBS_Ulemma_Happy
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Ulemma_Happy
		}
		swap_ideas = {
			remove_idea = JBS_Ulemma_Happy
			add_idea = JBS_Ulemma_Very_Happy
		}
	}
}

JBS_Decrease_Bedouin_Support = {
	custom_effect_tooltip = tooltip_white_line
	if = {
		limit = {
			has_idea = JBS_Bedouin_Very_Happy
		}
		swap_ideas = {
			remove_idea = JBS_Bedouin_Very_Happy
			add_idea = JBS_Bedouin_Happy
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Bedouin_Happy
		}
		swap_ideas = {
			remove_idea = JBS_Bedouin_Happy
			add_idea = JBS_Bedouin_Pleased
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Bedouin_Pleased
		}
		swap_ideas = {
			remove_idea = JBS_Bedouin_Pleased
			add_idea = JBS_Bedouin_Neutral
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Bedouin_Neutral
		}
		swap_ideas = {
			remove_idea = JBS_Bedouin_Neutral
			add_idea = JBS_Bedouin_Discontent
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Bedouin_Discontent
		}
		swap_ideas = {
			remove_idea = JBS_Bedouin_Discontent
			add_idea = JBS_Bedouin_Unhappy
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Bedouin_Unhappy
		}
		swap_ideas = {
			remove_idea = JBS_Bedouin_Unhappy
			add_idea = JBS_Bedouin_Very_Unhappy
		}
		hidden_effect = {
			country_event = {
				id = jbs.6
				days = 10
			}
		}
	}
}
JBS_Increase_Bedouin_Support = {
	custom_effect_tooltip = tooltip_white_line
	if = {
		limit = {
			has_idea = JBS_Bedouin_Very_Unhappy
		}
		swap_ideas = {
			remove_idea = JBS_Bedouin_Very_Unhappy
			add_idea = JBS_Bedouin_Unhappy
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Bedouin_Unhappy
		}
		swap_ideas = {
			remove_idea = JBS_Bedouin_Unhappy
			add_idea = JBS_Bedouin_Discontent
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Bedouin_Discontent
		}
		swap_ideas = {
			remove_idea = JBS_Bedouin_Discontent
			add_idea = JBS_Bedouin_Neutral
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Bedouin_Neutral
		}
		swap_ideas = {
			remove_idea = JBS_Bedouin_Neutral
			add_idea = JBS_Bedouin_Pleased
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Bedouin_Pleased
		}
		swap_ideas = {
			remove_idea = JBS_Bedouin_Pleased
			add_idea = JBS_Bedouin_Happy
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Bedouin_Happy
		}
		swap_ideas = {
			remove_idea = JBS_Bedouin_Happy
			add_idea = JBS_Bedouin_Very_Happy
		}
	}
}

JBS_Decrease_Urban_Nobility_Support = {
	custom_effect_tooltip = tooltip_white_line
	if = {
		limit = {
			has_idea = JBS_Urban_Nobility_Very_Happy
		}
		swap_ideas = {
			remove_idea = JBS_Urban_Nobility_Very_Happy
			add_idea = JBS_Urban_Nobility_Happy
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Urban_Nobility_Happy
		}
		swap_ideas = {
			remove_idea = JBS_Urban_Nobility_Happy
			add_idea = JBS_Urban_Nobility_Pleased
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Urban_Nobility_Pleased
		}
		swap_ideas = {
			remove_idea = JBS_Urban_Nobility_Pleased
			add_idea = JBS_Urban_Nobility_Neutral
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Urban_Nobility_Neutral
		}
		swap_ideas = {
			remove_idea = JBS_Urban_Nobility_Neutral
			add_idea = JBS_Urban_Nobility_Discontent
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Urban_Nobility_Discontent
		}
		swap_ideas = {
			remove_idea = JBS_Urban_Nobility_Discontent
			add_idea = JBS_Urban_Nobility_Unhappy
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Urban_Nobility_Unhappy
		}
		swap_ideas = {
			remove_idea = JBS_Urban_Nobility_Unhappy
			add_idea = JBS_Urban_Nobility_Very_Unhappy
		}
	}
	hidden_effect = {
		if = {
			limit = {
				NOT = {
					has_idea = JBS_unbridled_fratricide
					has_idea = JBS_looming_invasion
				}
			}
			country_event = {
				id = jbs.19
				days = 30
			}
		}
	}
}
JBS_Increase_Urban_Nobility_Support = {
	custom_effect_tooltip = tooltip_white_line
	if = {
		limit = {
			has_idea = JBS_Urban_Nobility_Very_Unhappy
		}
		swap_ideas = {
			remove_idea = JBS_Urban_Nobility_Very_Unhappy
			add_idea = JBS_Urban_Nobility_Unhappy
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Urban_Nobility_Unhappy
		}
		swap_ideas = {
			remove_idea = JBS_Urban_Nobility_Unhappy
			add_idea = JBS_Urban_Nobility_Discontent
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Urban_Nobility_Discontent
		}
		swap_ideas = {
			remove_idea = JBS_Urban_Nobility_Discontent
			add_idea = JBS_Urban_Nobility_Neutral
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Urban_Nobility_Neutral
		}
		swap_ideas = {
			remove_idea = JBS_Urban_Nobility_Neutral
			add_idea = JBS_Urban_Nobility_Pleased
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Urban_Nobility_Pleased
		}
		swap_ideas = {
			remove_idea = JBS_Urban_Nobility_Pleased
			add_idea = JBS_Urban_Nobility_Happy
		}
	}
	else_if = {
		limit = {
			has_idea = JBS_Urban_Nobility_Happy
		}
		swap_ideas = {
			remove_idea = JBS_Urban_Nobility_Happy
			add_idea = JBS_Urban_Nobility_Very_Happy
		}
	}
}

JBS_update_HEJ_leader = {
	hidden_effect = {
		if = {
			limit = {
				has_completed_focus = JBS_Constituent_Assembly
				has_subject = HEJ
			}
			HEJ = {
				if = {
					limit = {
						NOT = { has_country_leader = { character = HEJ_abdullah_bin_al_hussein} }
					}
					promote_character = {
						character = HEJ_abdullah_bin_al_hussein
						ideology = authoritarian_democrat_subtype
					}
					promote_character = {
						character = HEJ_abdullah_bin_al_hussein
						ideology = paternal_autocrat_subtype
					}
				}
			}
			if = {
				limit = {
					has_country_leader = { character = JBS_Abdallah_ibn_Talal_al_Rashid}
				}
				HEJ = {
					promote_character = {
						character = HEJ_abdallah_ibn_talal_al_rashid
						ideology = authoritarian_democrat_subtype
					}
					promote_character = {
						character = HEJ_abdallah_ibn_talal_al_rashid
						ideology = paternal_autocrat_subtype
					}
				}
			}
			else_if = {
				limit = {
					has_country_leader = { character = JBS_saud_al_subhan }
				}
				HEJ = {
					promote_character = {
						character = HEJ_saud_al_subhan
						ideology = authoritarian_democrat_subtype
					}
					promote_character = {
						character = HEJ_saud_al_subhan
						ideology = paternal_autocrat_subtype
					}
				}
			}
			else_if = {
				limit = {
					has_country_leader = { character = JBS_abdallah_ibn_mitab_ibn_abd_al_aziz_al_rashid }
				}
				HEJ = {
					promote_character = {
						character = HEJ_abdallah_ibn_mitab_ibn_abd_al_aziz_al_rashid
						ideology = authoritarian_democrat_subtype
					}
					promote_character = {
						character = HEJ_abdallah_ibn_mitab_ibn_abd_al_aziz_al_rashid
						ideology = paternal_autocrat_subtype
					}
				}
			}
			else_if = {
				limit = {
					has_country_leader = { character = JBS_muhammad_ibn_talil_al_rashid }
				}
				HEJ = {
					promote_character = {
						character = HEJ_muhammad_ibn_talil_al_rashid
						ideology = authoritarian_democrat_subtype
					}
					promote_character = {
						character = HEJ_muhammad_ibn_talil_al_rashid
						ideology = paternal_autocrat_subtype
					}
				}
			}
		}
	}
}

YEM_increase_integration = {
	effect_tooltip = {
		swap_ideas = {
			remove_idea = YEM_arabian_integration_1
			add_idea = YEM_arabian_integration_2
		}
	}
	hidden_effect = {
		if = {
			limit = { has_idea = YEM_arabian_integration_1 }
			swap_ideas = {
				remove_idea = YEM_arabian_integration_1
				add_idea = YEM_arabian_integration_2
			}
		}
		else_if = {
			limit = { has_idea = YEM_arabian_integration_2 }
			swap_ideas = {
				remove_idea = YEM_arabian_integration_2
				add_idea = YEM_arabian_integration_3
			}
		}
		else_if = {
			limit = { has_idea = YEM_arabian_integration_3 }
			swap_ideas = {
				remove_idea = YEM_arabian_integration_3
				add_idea = YEM_arabian_integration_4
			}
		}
		else_if = {
			limit = { has_idea = YEM_arabian_integration_4 }
			swap_ideas = {
				remove_idea = YEM_arabian_integration_4
				add_idea = YEM_arabian_integration_5
			}
		}
		else_if = {
			limit = { has_idea = YEM_arabian_integration_5 }
			swap_ideas = {
				remove_idea = YEM_arabian_integration_5
				add_idea = YEM_arabian_integration_6
			}
		}
	}
}

#scripted effect to remove the generals JBS gets from its decisions
JBS_remove_tribal_generals = {
	#Sa'adun loses his unit leader role and sent back to IRQ
	if = {
		limit = { has_character = IRQ_ajami_al_saadun }
		event_target:IRQ_Ajami_al_Saadun = {
			set_nationality = IRQ
			remove_unit_leader_role = yes
		}
	}
	#while the rest get retired
	if = {
		limit = {
			has_character = JBS_dulaim_ibn_barrak
		}
		effect_tooltip = { retire_character = JBS_dulaim_ibn_barrak }
		hidden_effect = { JBS_dulaim_ibn_barrak = { retire = yes } }
	}
	if = {
		limit = {
			has_character = IKH_zaidan_ibn_hithlain
		}
		event_target:IKH_zaidan_ibn_hithlain_target = {	set_nationality = IKH }
	}
	if = {
		limit = {
			has_character = JBS_abd_al_rahman_ibn_rubayin
		}
		effect_tooltip = { retire_character = JBS_abd_al_rahman_ibn_rubayin }
		hidden_effect = { JBS_abd_al_rahman_ibn_rubayin = { retire = yes } }
	}
}

JBS_create_abdallah_ibn_talal = {
	JBS = {
		promote_character = {
			character = JBS_abdallah_ibn_talal_al_rashid
			ideology = social_democrat_subtype
		}
		promote_character = {
			character = JBS_abdallah_ibn_talal_al_rashid
			ideology = social_liberal_subtype
		}
		promote_character = {
			character = JBS_abdallah_ibn_talal_al_rashid
			ideology = market_liberal_subtype
		}
		promote_character = {
			character = JBS_abdallah_ibn_talal_al_rashid
			ideology = social_conservative_subtype
		}
		promote_character = {
			character = JBS_abdallah_ibn_talal_al_rashid
			ideology = authoritarian_democrat_subtype
		}
		promote_character = {
			character = JBS_abdallah_ibn_talal_al_rashid
			ideology = paternal_autocrat_subtype
		}
		promote_character = {
			character = JBS_abdallah_ibn_talal_al_rashid
			ideology = national_populist_subtype
		}
		event_target:JBS_Abdallah_ibn_Mitab_ibn_Abd_al_Aziz = {
			promote_leader = yes
			remove_trait = { trait = recently_promoted }
		}
	}
	event_target:JBS_Abdallah_ibn_Talal_al_Rashid = {
		promote_leader = yes
		remove_trait = { trait = recently_promoted }
	}
	JBS_update_HEJ_leader = yes
}

JBS_create_abdallah_ibn_mitab = {
	JBS = {
		promote_character = {
			character = JBS_abdallah_ibn_mitab_ibn_abd_al_aziz_al_rashid
			ideology = social_democrat_subtype
		}
		promote_character = {
			character = JBS_abdallah_ibn_mitab_ibn_abd_al_aziz_al_rashid
			ideology = social_liberal_subtype
		}
		promote_character = {
			character = JBS_abdallah_ibn_mitab_ibn_abd_al_aziz_al_rashid
			ideology = market_liberal_subtype
		}
		promote_character = {
			character = JBS_abdallah_ibn_mitab_ibn_abd_al_aziz_al_rashid
			ideology = social_conservative_subtype
		}
		promote_character = {
			character = JBS_abdallah_ibn_mitab_ibn_abd_al_aziz_al_rashid
			ideology = authoritarian_democrat_subtype
		}
		promote_character = {
			character = JBS_abdallah_ibn_mitab_ibn_abd_al_aziz_al_rashid
			ideology = paternal_autocrat_subtype
		}
		promote_character = {
			character = JBS_abdallah_ibn_mitab_ibn_abd_al_aziz_al_rashid
			ideology = national_populist_subtype
		}
		event_target:JBS_Abdallah_ibn_Mitab_ibn_Abd_al_Aziz = {
			promote_leader = yes
			remove_trait = { trait = recently_promoted }
		}
		JBS_update_HEJ_leader = yes
	}
}

JBS_create_muhammad_ibn_talil_al_rashid = {
	JBS = {
		promote_character = {
			character = JBS_muhammad_ibn_talil_al_rashid
			ideology = social_democrat_subtype
		}
		promote_character = {
			character = JBS_muhammad_ibn_talil_al_rashid
			ideology = social_liberal_subtype
		}
		promote_character = {
			character = JBS_muhammad_ibn_talil_al_rashid
			ideology = market_liberal_subtype
		}
		promote_character = {
			character = JBS_muhammad_ibn_talil_al_rashid
			ideology = social_conservative_subtype
		}
		promote_character = {
			character = JBS_muhammad_ibn_talil_al_rashid
			ideology = authoritarian_democrat_subtype
		}
		promote_character = {
			character = JBS_muhammad_ibn_talil_al_rashid
			ideology = paternal_autocrat_subtype
		}
		promote_character = {
			character = JBS_muhammad_ibn_talil_al_rashid
			ideology = national_populist_subtype
		}
		event_target:JBS_Abdallah_ibn_Mitab_ibn_Abd_al_Aziz = {
			promote_leader = yes
			remove_trait = { trait = recently_promoted }
		}
	}
	event_target:JBS_Muhammad_ibn_Talil = {
		promote_leader = yes
		remove_trait = { trait = recently_promoted }
	}
	JBS_update_HEJ_leader = yes
}

JBS_create_saud_al_subhan = {
	JBS = {
		promote_character = {
			character = JBS_saud_al_subhan
			ideology = social_democrat_subtype
		}
		promote_character = {
			character = JBS_saud_al_subhan
			ideology = social_liberal_subtype
		}
		promote_character = {
			character = JBS_saud_al_subhan
			ideology = market_liberal_subtype
		}
		promote_character = {
			character = JBS_saud_al_subhan
			ideology = social_conservative_subtype
		}
		promote_character = {
			character = JBS_saud_al_subhan
			ideology = authoritarian_democrat_subtype
		}
		promote_character = {
			character = JBS_saud_al_subhan
			ideology = paternal_autocrat_subtype
		}
		promote_character = {
			character = JBS_saud_al_subhan
			ideology = national_populist_subtype
		}
		event_target:JBS_Saud_al_Subhan = {
			add_field_marshal_role = {
				traits = { politically_connected }
				skill = 2
				attack_skill = 2
				defense_skill = 2
				planning_skill = 2
				logistics_skill = 1
			}
		}
		JBS_update_HEJ_leader = yes
	}
}

# removes roles from rashids but not their charachter, so they could be restored, and replace them with Subhan
JBS_remove_rashids = {
	JBS_create_saud_al_subhan = yes
	set_party_name = {
		ideology = authoritarian_democrat
		long_name = "al-Subhan"
		name = "al-Subhan"
	}
	if = {
		limit = {
			has_character = JBS_saud_bin_abd_al_aziz
			JBS_saud_bin_abd_al_aziz = { is_unit_leader = yes }
		}
		effect_tooltip = { retire_character = JBS_saud_bin_abd_al_aziz }
		hidden_effect = {
			event_target:JBS_Aziz_Emir = {
				remove_unit_leader_role = yes
			}
		}
	}
	if = {
		limit = {
			has_character = JBS_abdallah_ibn_talal_al_rashid
			JBS_abdallah_ibn_talal_al_rashid = { is_unit_leader = yes }
		}
		effect_tooltip = { retire_character = JBS_abdallah_ibn_talal_al_rashid }
		hidden_effect = {
			event_target:JBS_Abdallah_ibn_Talal_al_Rashid = {
				remove_unit_leader_role = yes
			}
		}
	}
	if = {
		limit = {
			has_character = JBS_abdallah_ibn_mitab_ibn_abd_al_aziz_al_rashid
			JBS_abdallah_ibn_mitab_ibn_abd_al_aziz_al_rashid = { is_unit_leader = yes }
		}
		effect_tooltip = { retire_character = JBS_abdallah_ibn_mitab_ibn_abd_al_aziz_al_rashid }
		hidden_effect = {
			event_target:JBS_Abdallah_ibn_Mitab_ibn_Abd_al_Aziz = {
				remove_unit_leader_role = yes
			}
		}
	}
	if = {
		limit = {
			has_character = JBS_muhammad_ibn_talil_al_rashid
			JBS_muhammad_ibn_talil_al_rashid = { is_unit_leader = yes }
		}
		effect_tooltip = { retire_character = JBS_muhammad_ibn_talil_al_rashid }
		hidden_effect = {
			event_target:JBS_Muhammad_ibn_Talil = {
				remove_unit_leader_role = yes
			}
		}
	}
}

JBS_restore_rashids = {
	###opposite of remove effect- puts ibn mitab as HoS and general, and gives general role to the other rashidis provided they are still alive
	set_party_name = {
		ideology = authoritarian_democrat
		long_name = "al Rashid"
		name = "al Rashid"
	}
	if = {
		limit = {
			has_character = JBS_abdallah_ibn_mitab_ibn_abd_al_aziz_al_rashid
			JBS_abdallah_ibn_mitab_ibn_abd_al_aziz_al_rashid = { is_unit_leader = no }
		}
		event_target:JBS_Abdallah_ibn_Mitab_ibn_Abd_al_Aziz = {
			add_corps_commander_role = {
				traits = { politically_connected }
				skill = 1
				attack_skill = 1
				defense_skill = 1
				planning_skill = 1
				logistics_skill = 1
			}
		}
		JBS_create_abdallah_ibn_mitab = yes
	}
	if = {
		limit = {
			has_character = JBS_saud_al_subhan
			JBS_saud_al_subhan = { is_unit_leader = yes }
		}
		effect_tooltip = { retire_character = JBS_saud_al_subhan }
		hidden_effect = {
			event_target:JBS_Saud_al_Subhan = {
				remove_unit_leader_role = yes
			}
		}
	}
	custom_effect_tooltip = tooltip_white_line
	if = {
		limit = {
			has_character = JBS_abdallah_ibn_talal_al_rashid
			JBS_abdallah_ibn_talal_al_rashid = { is_unit_leader = no }
		}
		event_target:JBS_Abdallah_ibn_Talal_al_Rashid = {
			add_corps_commander_role = {
				traits = { politically_connected }
				skill = 1
				attack_skill = 1
				defense_skill = 1
				planning_skill = 1
				logistics_skill = 1
			}
		}
	}
	if = {
		limit = {
			has_character = JBS_saud_bin_abd_al_aziz
			JBS_saud_bin_abd_al_aziz = { is_unit_leader = no }
		}
		event_target:JBS_Aziz_Emir = {
			add_corps_commander_role = {
				traits = { offensive_doctrine politically_connected trait_cautious }
				skill = 2
				attack_skill = 2
				defense_skill = 2
				planning_skill = 2
				logistics_skill = 1
			}
		}
	}
	if = {
		limit = {
			has_character = JBS_muhammad_ibn_talil_al_rashid
			JBS_muhammad_ibn_talil_al_rashid = { is_unit_leader = no }
		}
		event_target:JBS_Muhammad_ibn_Talil = {
			add_corps_commander_role = {
				traits = { politically_connected }
				skill = 1
				attack_skill = 1
				defense_skill = 1
				planning_skill = 1
				logistics_skill = 1
			}
		}
	}
}

SAU_create_saud_bin_abdulaziz_al_saud = {
	event_target:SAU_saud_bin_abdulaziz_al_saud_target = {
		promote_leader = yes
		remove_trait = { trait = recently_promoted }
	}
	SAU_saud_bin_abdulaziz_al_saud = {
		if = {
			limit = { has_ideology = social_democrat_subtype }
			promote_character = { ideology = social_democrat_subtype }
		}
		else = {
			add_country_leader_role = {
				country_leader = { ideology = social_democrat_subtype }
				promote_leader = yes
			}
		}
		if = {
			limit = { has_ideology = social_liberal_subtype }
			promote_character = { ideology = social_liberal_subtype }
		}
		else = {
			add_country_leader_role = {
				country_leader = { ideology = social_liberal_subtype }
				promote_leader = yes
			}
		}
		if = {
			limit = { has_ideology = market_liberal_subtype }
			promote_character = { ideology = market_liberal_subtype }
		}
		else = {
			add_country_leader_role = {
				country_leader = { ideology = market_liberal_subtype }
				promote_leader = yes
			}
		}
		if = {
			limit = { has_ideology = social_conservative_subtype }
			promote_character = { ideology = social_conservative_subtype }
		}
		else = {
			add_country_leader_role = {
				country_leader = { ideology = social_conservative_subtype }
				promote_leader = yes
			}
		}
		if = {
			limit = { has_ideology = authoritarian_democrat_subtype }
			promote_character = { ideology = authoritarian_democrat_subtype }
		}
		else = {
			add_country_leader_role = {
				country_leader = { ideology = authoritarian_democrat_subtype }
				promote_leader = yes
			}
		}
		if = {
			limit = { has_ideology = paternal_autocrat_subtype }
			promote_character = { ideology = paternal_autocrat_subtype }
		}
		else = {
			add_country_leader_role = {
				country_leader = { ideology = paternal_autocrat_subtype }
				promote_leader = yes
			}
		}
		if = {
			limit = { has_ideology = national_populist_subtype }
			promote_character = { ideology = national_populist_subtype }
		}
		else = {
			add_country_leader_role = {
				country_leader = { ideology = national_populist_subtype }
				promote_leader = yes
			}
		}
	}
}

IKH_start_rebellion = {
	hidden_effect = {
		news_event = worldnews.440
		IKH = {
			#State
			add_state_core = 991
			transfer_state = 991
			add_state_core = 675
			transfer_state = 675
			set_capital = { state = 991 }
			drop_cosmetic_tag = yes

			### Politics
			if = {
				limit = { NOT = { has_character = IKH_faisal_al_duwaish } }
				event_target:IKH_faisal_al_duwaish_target = {
					set_nationality = IKH
					promote_leader = yes
					remove_trait = { trait = recently_promoted }
				}
				IKH_faisal_al_duwaish = {
					if = {
						limit = { has_ideology = paternal_autocrat_subtype }
						promote_character = { ideology = paternal_autocrat_subtype }
					}
					else = {
						add_country_leader_role = {
							country_leader = { ideology = paternal_autocrat_subtype }
							promote_leader = yes
						}
					}
				}
			}
			set_popularities = {
				totalist = 0
				radical_socialist = 0
				syndicalist = 0
				social_democrat = 0
				social_liberal = 0
				market_liberal = 0
				social_conservative = 0
				authoritarian_democrat = 0
				paternal_autocrat = 100
				national_populist = 0
			}
			set_party_name = {
				ideology = paternal_autocrat
				long_name = "al Dawish"
				name = "al Dawish"
			}
			set_politics = {
				ruling_party = paternal_autocrat
				elections_allowed = no
			}

			#War
			declare_war_on = {
				target = ROOT
				type = annex_everything
			}

			#Provinces
			set_province_controller = 5099
			set_province_controller = 12316

			#Units
			division_template = {
				name = "Ikhwan"
				division_names_group = SAU_CAV_01
				is_locked = yes
				regiments = {
					cavalry = { x = 0 y = 0 }
					cavalry = { x = 0 y = 1 }
					cavalry = { x = 0 y = 2 }
				}
			}
			1035 = {
				create_unit = {
					division = "name = \"Ruwala\" division_template = \"Ikhwan\"  start_experience_factor = 0.3"
					allow_spawning_on_enemy_provs = yes
					owner = PREV
					prioritize_location = 5099
				}
			}
			675 = {
				create_unit = {
					division = "name = \"Utaibah\" division_template = \"Ikhwan\"  start_experience_factor = 0.3"
					allow_spawning_on_enemy_provs = yes
					owner = PREV
					prioritize_location = 10892
				}
			}
			991 = {
				create_unit = {
					division = "name = \"Mutasir\" division_template = \"Ikhwan\"  start_experience_factor = 0.3"
					allow_spawning_on_enemy_provs = yes
					owner = PREV
					prioritize_location = 10850
				}
				create_unit = {
					division = "name = \"Mutasir\" division_template = \"Ikhwan\"  start_experience_factor = 0.3"
					allow_spawning_on_enemy_provs = yes
					owner = PREV
					prioritize_location = 10850
				}
			}
		}
	}
}

#scripted effect for what happens when IKH wins that revolt and splits
IKH_Split_into_four = {
	delete_unit_template_and_units = { division_template = "Ikhwan" }
	IKH = { # Riyadh
		### Politics
		set_popularities = {
			totalist = 0
			radical_socialist = 0
			syndicalist = 0
			social_democrat = 0
			social_liberal = 0
			market_liberal = 0
			social_conservative = 0
			authoritarian_democrat = 0
			paternal_autocrat = 100
			national_populist = 0
		}
		set_party_name = {
			ideology = paternal_autocrat
			long_name = "al Dawish"
			name = "al Dawish"
		}
		set_politics = {
			ruling_party = paternal_autocrat
			elections_allowed = no
		}
		set_cosmetic_tag = NAJ

		#Units
		if = {
			limit = { has_template = "Ikhwan" }
			set_division_template_lock = {
				division_template = "Ikhwan"
				is_locked = no
			}
		}
		else = {
			division_template = {
				name = "Ikhwan"
				division_names_group = SAU_CAV_01
				is_locked = no
				regiments = {
					cavalry = { x = 0 y = 0 }
					cavalry = { x = 0 y = 1 }
					cavalry = { x = 1 y = 0 }
					cavalry = { x = 1 y = 1 }
				}
			}
		}
		292 = {
			create_unit = {
				division = "name = \"Mutasir\" division_template = \"Ikhwan\"  start_experience_factor = 0.3"
				allow_spawning_on_enemy_provs = yes
				owner = PREV
				prioritize_location = 4974
			}
			create_unit = {
				division = "name = \"Mutasir\" division_template = \"Ikhwan\"  start_experience_factor = 0.3"
				allow_spawning_on_enemy_provs = yes
				owner = PREV
				prioritize_location = 12727
			}
			create_unit = {
				division = "name = \"Mutasir\" division_template = \"Ikhwan\"  start_experience_factor = 0.3"
				allow_spawning_on_enemy_provs = yes
				owner = PREV
				prioritize_location = 5093
			}
		}
	}
	create_dynamic_country = {	#Utaibah
		original_tag = IKH
		copy_tag = IKH

		#State
		transfer_state = 675

		### Leader
		event_target:IKH_sultan_ibn_humaid_ibn_bijad_target = {
			set_nationality = PREV
			promote_leader = yes
			remove_trait = { trait = recently_promoted }
		}
		IKH_sultan_ibn_humaid_ibn_bijad = {
			if = {
				limit = { has_ideology = paternal_autocrat_subtype }
				promote_character = { ideology = paternal_autocrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = { ideology = paternal_autocrat_subtype }
					promote_leader = yes
				}
			}
		}

		### Politics
		set_popularities = {
			totalist = 0
			radical_socialist = 0
			syndicalist = 0
			social_democrat = 0
			social_liberal = 0
			market_liberal = 0
			social_conservative = 0
			authoritarian_democrat = 0
			paternal_autocrat = 100
			national_populist = 0
		}
		set_party_name = {
			ideology = paternal_autocrat
			long_name = "Ibn Bijad"
			name = "Ibn Bijad"
		}
		set_politics = {
			ruling_party = paternal_autocrat
			elections_allowed = no
		}
		set_cosmetic_tag = UTA

		#Units
		if = {
			limit = { has_template = "Ikhwan" }
			set_division_template_lock = {
				division_template = "Ikhwan"
				is_locked = no
			}
		}
		else = {
			division_template = {
				name = "Ikhwan"
				division_names_group = SAU_CAV_01
				is_locked = no
				regiments = {
					cavalry = { x = 0 y = 0 }
					cavalry = { x = 0 y = 1 }
					cavalry = { x = 1 y = 0 }
					cavalry = { x = 1 y = 1 }
				}
			}
		}
		675 = {
			create_unit = {
				division = "name = \"Utaibah\" division_template = \"Ikhwan\"  start_experience_factor = 0.3"
				allow_spawning_on_enemy_provs = yes
				owner = PREV
				prioritize_location = 10923
			}
			create_unit = {
				division = "name = \"Utaibah\" division_template = \"Ikhwan\"  start_experience_factor = 0.3"
				allow_spawning_on_enemy_provs = yes
				owner = PREV
				prioritize_location = 8004
			}
		}

		#Event Target
		save_global_event_target_as = buraida
	}
	create_dynamic_country = {	#al-Hasa
		original_tag = IKH
		copy_tag = IKH

		#State
		if = {
			limit = { ROOT = { owns_state = 656 } }
			transfer_state = 656
			set_cosmetic_tag = HAS
			set_temp_variable = { IKH_state_target = 656.id }
		}
		else = {
			set_cosmetic_tag = SUM
			set_temp_variable = { IKH_state_target = 991.id }
		}
		transfer_state = 991

		### Leader
		event_target:IKH_zaidan_ibn_hithlain_target = {
			set_nationality = PREV
			promote_leader = yes
			remove_trait = { trait = recently_promoted }
		}
		IKH_zaidan_ibn_hithlain = {
			if = {
				limit = { has_ideology = paternal_autocrat_subtype }
				promote_character = { ideology = paternal_autocrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = { ideology = paternal_autocrat_subtype }
					promote_leader = yes
				}
			}
		}

		### Politics
		set_popularities = {
			totalist = 0
			radical_socialist = 0
			syndicalist = 0
			social_democrat = 0
			social_liberal = 0
			market_liberal = 0
			social_conservative = 0
			authoritarian_democrat = 0
			paternal_autocrat = 100
			national_populist = 0
		}
		set_party_name = {
			ideology = paternal_autocrat
			long_name = "Ibn Hithlain"
			name = "Ibn Hithlain"
		}
		set_politics = {
			ruling_party = paternal_autocrat
			elections_allowed = no
		}
		if = {
			limit = { ROOT = { owns_state = 656 } }
			set_cosmetic_tag = HAS
		}
		else = {
			set_cosmetic_tag = SUM
		}

		#Units
		if = {
			limit = { has_template = "Ikhwan" }
			set_division_template_lock = {
				division_template = "Ikhwan"
				is_locked = no
			}
		}
		else = {
			division_template = {
				name = "Ikhwan"
				division_names_group = SAU_CAV_01
				is_locked = no
				regiments = {
					cavalry = { x = 0 y = 0 }
					cavalry = { x = 0 y = 1 }
					cavalry = { x = 1 y = 0 }
					cavalry = { x = 1 y = 1 }
				}
			}
		}
		var:IKH_state_target = {
			create_unit = {
				division = "name = \"Ajman\" division_template = \"Ikhwan\"  start_experience_factor = 0.3"
				allow_spawning_on_enemy_provs = yes
				owner = PREV
				prioritize_location = 10791
			}
			create_unit = {
				division = "name = \"Ajman\" division_template = \"Ikhwan\"  start_experience_factor = 0.3"
				allow_spawning_on_enemy_provs = yes
				owner = PREV
				prioritize_location = 1955
			}
		}

		#Event Target
		save_global_event_target_as = al_hasa
	}
	create_dynamic_country = {	#Ha'il
		original_tag = IKH
		copy_tag = IKH

		#State
		transfer_state = 915
		transfer_state = 1035
		transfer_state = 994

		### Leader
		event_target:IKH_nida_ibn_nuhair_target = {
			set_nationality = PREV
			promote_leader = yes
			remove_trait = { trait = recently_promoted }
		}
		IKH_nida_ibn_nuhair = {
			if = {
				limit = { has_ideology = paternal_autocrat_subtype }
				promote_character = { ideology = paternal_autocrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = { ideology = paternal_autocrat_subtype }
					promote_leader = yes
				}
			}
		}

		### Politics
		set_popularities = {
			totalist = 0
			radical_socialist = 0
			syndicalist = 0
			social_democrat = 0
			social_liberal = 0
			market_liberal = 0
			social_conservative = 0
			authoritarian_democrat = 0
			paternal_autocrat = 100
			national_populist = 0
		}
		set_party_name = {
			ideology = paternal_autocrat
			long_name = "Ibn Nuhair"
			name = "Ibn Nuhair"
		}
		set_politics = {
			ruling_party = paternal_autocrat
			elections_allowed = no
		}
		set_cosmetic_tag = HAL

		#Units
		if = {
			limit = { has_template = "Ikhwan" }
			set_division_template_lock = {
				division_template = "Ikhwan"
				is_locked = no
			}
		}
		else = {
			division_template = {
				name = "Ikhwan"
				division_names_group = SAU_CAV_01
				is_locked = no
				regiments = {
					cavalry = { x = 0 y = 0 }
					cavalry = { x = 0 y = 1 }
					cavalry = { x = 1 y = 0 }
					cavalry = { x = 1 y = 1 }
				}
			}
		}
		915 = {
			create_unit = {
				division = "name = \"Utaibah\" division_template = \"Ikhwan\"  start_experience_factor = 0.3"
				allow_spawning_on_enemy_provs = yes
				owner = PREV
				prioritize_location = 7934
			}
			create_unit = {
				division = "name = \"Utaibah\" division_template = \"Ikhwan\"  start_experience_factor = 0.3"
				allow_spawning_on_enemy_provs = yes
				owner = PREV
				prioritize_location = 13666
			}
		}

		#Event Target
		save_global_event_target_as = hail
	}
	## War declarations
	IKH = {
		for_each_scope_loop = {
			array = core_states
			add_core_of = event_target:buraida
			add_core_of = event_target:hail
			add_core_of = event_target:al_hasa
		}
	}
	every_country_with_original_tag = {
		original_tag_to_check = IKH
		if = {
			limit = { can_declare_war_on = IKH }
			declare_war_on = {
				target = IKH
				type = annex_everything
			}
		}
		if = {
			limit = { can_declare_war_on = event_target:buraida }
			declare_war_on = {
				target = event_target:buraida
				type = annex_everything
			}
		}
		if = {
			limit = { can_declare_war_on = event_target:hail }
			declare_war_on = {
				target = event_target:hail
				type = annex_everything
			}
		}
		if = {
			limit = { can_declare_war_on = event_target:al_hasa }
			declare_war_on = {
				target = event_target:al_hasa
				type = annex_everything
			}
		}
	}
	set_global_flag = rumble_in_the_dunes
}

JBS_SAU_Remove_Power_Struggle_Decisions = { #get removed via hidden event 26 days after war starts since has_decision didn't work
	JBS = {
		remove_targeted_decision = { target = 915 decision = JBS_Sway_Harb }
		remove_targeted_decision = { target = 994 decision = JBS_Sway_Hutaim }
		remove_targeted_decision = { target = 291 decision = JBS_Sway_Muntafiq }
		remove_targeted_decision = { target = 1035 decision = JBS_Sway_Anizzah }
		remove_targeted_decision = { target = 991 decision = JBS_Sway_Mutair_Dawish }
		remove_targeted_decision = { target = 675 decision = JBS_Sway_Mutair_Busayis }
		remove_targeted_decision = { target = 991 decision = JBS_Sway_Ajman }
		remove_targeted_decision = { target = 675 decision = JBS_Sway_Utaibah }
		remove_targeted_decision = { target = 656 decision = JBS_Sway_Awazim }
	}
	SAU = {
		remove_targeted_decision = { target = 1035 decision = SAU_Sway_Ruwala }
		remove_targeted_decision = { target = 1035 decision = SAU_Sway_Anizzah }
		remove_targeted_decision = { target = 1035 decision = SAU_Sway_Dhafir }
		remove_targeted_decision = { target = 675 decision = SAU_Sway_Mutair_Busayis }
		remove_targeted_decision = { target = 675 decision = SAU_Sway_Utaibah_Ikh }
		remove_targeted_decision = { target = 675 decision = SAU_Sway_Utaibah }
		remove_targeted_decision = { target = 292 decision = SAU_Sway_Duwasir }
	}
}

JBS_readd_claims_after_puppeting = {
	hidden_effect = {
		every_state = {
			limit = {
				is_arabia = yes
				is_owned_by = OTT
				NOT = {
					is_core_of = OTT
					is_claimed_by = OTT
				}
			}
			add_claim_by = JBS
		}
	}
}
